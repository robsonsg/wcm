import{l as Q,w as H}from"./chunk-RLCM72IK.js";import{Ca as h,Db as w,Ec as u,Ib as b,Jb as d,Kb as B,Lb as P,Pb as E,Qb as I,Ra as r,Rb as j,Ub as A,Vb as l,Wb as L,Xb as m,Ya as D,a as k,ab as T,g as p,ga as M,gb as g,oa as C,ob as f,pa as y,pb as V,qa as O,qb as v,rb as $,sb as S,ua as N,xa as _,xb as i,xc as z,yb as c,zb as x}from"./chunk-27GLVKKX.js";var W=["modalBackdrop"],q=["modalContainer"],F=["dynamicComponentContainer"],K=["*"];function G(o,n){if(o&1&&(i(0,"h3",17),l(1),c()),o&2){let e=d(3);r(),m(" ",e.config.header," ")}}function U(o,n){if(o&1){let e=w();i(0,"button",18),b("click",function(){C(e);let s=d(3);return y(s.close())}),O(),i(1,"svg",19),x(2,"path",20),c()()}}function J(o,n){if(o&1&&(i(0,"div",14),g(1,G,2,1,"h3",15)(2,U,3,0,"button",16),c()),o&2){let e=d(2);r(),f("ngIf",e.config.header),r(),f("ngIf",e.config.showCloseButton!==!1)}}function X(o,n){o&1&&(i(0,"div",21),x(1,"div",22),i(2,"span",23),l(3,"Carregando componente..."),c()())}function Y(o,n){if(o&1){let e=w();i(0,"div",24)(1,"p")(2,"strong"),l(3,"Erro ao carregar componente:"),c()(),i(4,"p"),l(5),c(),i(6,"button",25),b("click",function(){C(e);let s=d(2);return y(s.retryLoadComponent())}),l(7," Tentar novamente "),c()()}if(o&2){let e=d(2);r(5),L(e.errorMessage())}}function Z(o,n){if(o&1&&(i(0,"div",26)(1,"p")(2,"strong"),l(3,"\u{1F50D} Debug Info:"),c()(),i(4,"p"),l(5),c(),i(6,"p"),l(7,"Modal ID: "),i(8,"span",27),l(9),c()(),i(10,"p"),l(11),c(),i(12,"p"),l(13),c(),i(14,"p"),l(15),c(),i(16,"p"),l(17),c(),i(18,"p"),l(19),c(),i(20,"p"),l(21),c(),i(22,"p"),l(23),c()()),o&2){d();let e=A(11),t=d();r(5),m("Modal Open: ",t.isOpen(),""),r(4),L(t.config.modalId||"N/A"),r(2),m("Component Name: ",t.config.componentName||"N/A",""),r(2),m("Component Path: ",t.config.componentPath||"N/A",""),r(2),m("Component Type: ",(t.config.component==null?null:t.config.component.name)||"N/A",""),r(2),m("Has Injected Component: ",!!t.injectedComponentRef,""),r(2),m("Dynamic Container Ready: ",!!e,""),r(2),m("Is Loading: ",t.isLoading(),""),r(2),m("Has Error: ",t.hasError(),"")}}function ee(o,n){o&1&&(i(0,"div",28)(1,"p"),l(2,"Nenhum conte\xFAdo para exibir"),c(),i(3,"p",29),l(4,"Verifique se o componente foi configurado corretamente"),c()())}function te(o,n){if(o&1){let e=w();i(0,"div",4,0),b("click",function(s){C(e);let a=d();return y(a.onBackdropClick(s))}),x(2,"div",5),i(3,"div",6,1),b("click",function(s){return C(e),y(s.stopPropagation())}),g(5,J,3,2,"div",7),i(6,"div",8),g(7,X,4,0,"div",9)(8,Y,8,1,"div",10)(9,Z,24,9,"div",11),x(10,"div",12,2),P(12,0,["[class.hidden]","isLoading() || hasError()"]),g(13,ee,5,0,"div",13),c()()()}if(o&2){let e=d();S(e.backdropClasses()),V("z-index",e.config.zIndex||40),v("z-40",e.config.zIndex===void 0),r(2),v("opacity-50",e.config.backdrop!==!1)("opacity-0",e.config.backdrop===!1),r(),$(e.modalStyles()),S(e.modalClasses()),r(2),f("ngIf",e.config.header||e.config.showCloseButton!==!1),r(2),f("ngIf",e.isLoading()),r(),f("ngIf",e.hasError()),r(),f("ngIf",e.showDebugInfo&&!e.isLoading()),r(),v("hidden",e.isLoading()||e.hasError()),r(3),f("ngIf",!e.hasContent()&&!e.isLoading()&&!e.hasError())}}var R=class{static components=new Map;static componentsConfig=new Map;static register(n,e,t){this.components.set(n,e),t&&this.componentsConfig.set(n,k({name:n,loader:e},t))}static load(n){return p(this,null,function*(){let e=this.components.get(n);if(e)try{let t=yield e();return console.log(`Componente carregado com sucesso: ${n}`,t),t}catch(t){throw console.error(`Erro ao carregar componente ${n}:`,t),t}return console.warn(`Componente n\xE3o encontrado no registro: ${n}`),null})}static isRegistered(n){return this.components.has(n)}static getRegisteredComponents(){return Array.from(this.components.keys())}static getComponentConfig(n){return this.componentsConfig.get(n)}static loadByPath(n,e){return p(this,null,function*(){try{console.log(`Tentando carregar componente por caminho: ${n}`);let t=yield import(n),s=[e,"default",...Object.keys(t).filter(a=>a.endsWith("Component")),Object.keys(t)[0]].filter(Boolean);for(let a of s)if(t[a])return console.log(`Componente encontrado: ${a} em ${n}`),t[a];throw new Error(`Nenhum componente encontrado no caminho: ${n}`)}catch(t){throw console.error(`Erro ao carregar componente por caminho ${n}:`,t),t}})}static debug(){console.log("=== ComponentRegistry Debug ==="),console.log("Componentes registrados:",this.getRegisteredComponents()),console.log("Total:",this.components.size),this.componentsConfig.forEach((n,e)=>{console.log(`- ${e}: ${n.description} [${n.category}]`)})}},me=(()=>{class o{config={};showDebugInfo=!1;modalClose=new _;modalOpen=new _;componentLoaded=new _;componentLoadError=new _;modalBackdrop;modalContainer;dynamicComponentContainer;_isOpen=h(!1);_hasContent=h(!1);_isLoading=h(!1);_hasError=h(!1);_errorMessage=h("");injectedComponentRef=null;injector=M(N);cdr=M(z);isOpen=u(()=>this._isOpen());hasContent=u(()=>this._hasContent());isLoading=u(()=>this._isLoading());hasError=u(()=>this._hasError());errorMessage=u(()=>this._errorMessage());ngOnInit(){this.config=k({showCloseButton:!0,backdrop:!0,backdropClose:!0,position:"center",debugConsole:!1},this.config),this.config.debugConsole&&console.log("\u{1F4CB} Modal ngOnInit - config:",this.config)}ngAfterViewInit(){this.config.debugConsole&&console.log("\u{1F4CB} Modal ngAfterViewInit - container:",!!this.dynamicComponentContainer),this.hasComponentConfig()&&this.dynamicComponentContainer&&setTimeout(()=>{this.loadAndInjectComponent()},30)}ngOnDestroy(){this.destroyInjectedComponent(),typeof document<"u"&&document.removeEventListener("keydown",this.handleEscKey)}open(){return p(this,null,function*(){this.config.debugConsole&&console.log("\u{1F680} Modal open() called - config:",this.config),this._isOpen.set(!0),this.modalOpen.emit(),setTimeout(()=>p(this,null,function*(){this.hasComponentConfig()&&(this.config.debugConsole&&console.log("Carregando componente ap\xF3s abertura"),yield this.loadAndInjectComponent()),this.updateContentStatus()}),50),typeof document<"u"&&(document.addEventListener("keydown",this.handleEscKey),document.body.style.overflow="hidden")})}close(){this._isOpen.set(!1),this._hasContent.set(!1),this._isLoading.set(!1),this._hasError.set(!1),this.modalClose.emit(),this.destroyInjectedComponent(),typeof document<"u"&&(document.removeEventListener("keydown",this.handleEscKey),document.body.style.overflow="")}hasComponentConfig(){return!!(this.config.component||this.config.componentName||this.config.componentPath||this.config.componentLoader)}loadAndInjectComponent(){return p(this,null,function*(){if(!this.hasComponentConfig()){this.config.debugConsole&&console.warn("Nenhuma configura\xE7\xE3o de componente encontrada");return}this._isLoading.set(!0),this._hasError.set(!1),this._errorMessage.set("");try{let e=null;if(this.config.component)e=this.config.component,this.config.debugConsole&&console.log("Usando componente pr\xE9-instanciado:",e.name);else if(this.config.componentLoader)this.config.debugConsole&&console.log("Carregando via loader personalizado"),e=yield this.config.componentLoader();else if(this.config.componentName){if(this.config.debugConsole&&console.log("Carregando por nome:",this.config.componentName),e=yield R.load(this.config.componentName),!e)throw new Error(`Componente '${this.config.componentName}' n\xE3o encontrado no registro`)}else this.config.componentPath&&(this.config.debugConsole&&console.log("Carregando por caminho:",this.config.componentPath),e=yield this.loadComponentByPath(this.config.componentPath));if(!e)throw new Error("N\xE3o foi poss\xEDvel determinar o tipo do componente");yield this.injectComponent(e,this.config.componentInputs)}catch(e){let t=e instanceof Error?e.message:"Erro desconhecido";console.error("Erro ao carregar componente:",e),this._hasError.set(!0),this._errorMessage.set(t),this.componentLoadError.emit(t)}finally{this._isLoading.set(!1)}})}loadComponentByPath(e){return p(this,null,function*(){try{let t=yield import(e),s=[this.config.componentName?this.config.componentName+"Component":null,"default",Object.keys(t).find(a=>a.endsWith("Component")),Object.keys(t)[0]].filter(Boolean);for(let a of s)if(a&&t[a])return this.config.debugConsole&&console.log(`Componente encontrado: ${a}`),t[a];throw new Error(`Nenhum componente encontrado no caminho: ${e}`)}catch(t){throw new Error(`Erro ao importar componente do caminho '${e}': ${t}`)}})}retryLoadComponent(){return p(this,null,function*(){yield this.loadAndInjectComponent()})}injectComponent(e,t){return p(this,null,function*(){if(this.config.debugConsole&&(console.log("=== injectComponent called ==="),console.log("Component:",e),console.log("Inputs:",t)),this.destroyInjectedComponent(),!e)throw new Error("Componente n\xE3o fornecido");if(!this.dynamicComponentContainer)throw new Error("Container din\xE2mico n\xE3o est\xE1 dispon\xEDvel");try{this.injectedComponentRef=this.dynamicComponentContainer.createComponent(e,{injector:this.injector}),this.config.debugConsole&&console.log("Componente criado com sucesso:",this.injectedComponentRef),t&&Object.keys(t).length>0&&Object.keys(t).forEach(s=>{this.injectedComponentRef?.instance&&(this.injectedComponentRef.instance[s]=t[s],this.config.debugConsole&&console.log(`Input ${s} aplicado:`,t[s]))}),this.injectedComponentRef.instance&&typeof this.injectedComponentRef.instance.closeModal=="function"&&(this.injectedComponentRef.instance.closeModal=()=>this.close()),this.injectedComponentRef.changeDetectorRef.detectChanges(),this.cdr.detectChanges(),this._hasContent.set(!0),this.componentLoaded.emit(this.injectedComponentRef),this.config.debugConsole&&console.log("=== Component injection completed successfully ===")}catch(s){throw console.error("Erro ao injetar componente:",s),s}})}updateContentStatus(){let e=!!this.injectedComponentRef,t=this.modalContainer?.nativeElement?.querySelector("ng-content")?.children?.length>0;this._hasContent.set(e||t),this.config.debugConsole&&console.log("Content status updated:",this._hasContent())}destroyInjectedComponent(){this.injectedComponentRef&&(this.config.debugConsole&&console.log("Destroying injected component"),this.injectedComponentRef.destroy(),this.injectedComponentRef=null,this._hasContent.set(!1))}toggle(){this.isOpen()?this.close():this.open()}handleEscKey=e=>{e.key==="Escape"&&this.close()};onBackdropClick(e){this.config.backdropClose!==!1&&e.target===this.modalBackdrop?.nativeElement&&this.close()}backdropClasses(){let e=[];switch(this.config.position){case"top":e.push("items-start","pt-8");break;case"bottom":e.push("items-end","pb-8");break;default:e.push("items-center")}return e.join(" ")}modalClasses(){let e=["mx-4","my-4"];return e.push("w-full","sm:w-auto"),e.join(" ")}modalStyles(){let e={};return this.config.minWidth&&(e["min-width"]=this.config.minWidth),this.config.minHeight&&(e["min-height"]=this.config.minHeight),this.config.maxWidth&&(e["max-width"]=this.config.maxWidth),this.config.maxHeight&&(e["max-height"]=this.config.maxHeight),e}debugInfo(){return{isOpen:this.isOpen(),hasContent:this.hasContent(),isLoading:this.isLoading(),hasError:this.hasError(),errorMessage:this.errorMessage(),hasInjectedComponent:!!this.injectedComponentRef,componentName:this.config.component?.name||this.config.componentName,containerReady:!!this.dynamicComponentContainer}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=T({type:o,selectors:[["app-modal"]],viewQuery:function(t,s){if(t&1&&(E(W,5),E(q,5),E(F,5,D)),t&2){let a;I(a=j())&&(s.modalBackdrop=a.first),I(a=j())&&(s.modalContainer=a.first),I(a=j())&&(s.dynamicComponentContainer=a.first)}},inputs:{config:"config",showDebugInfo:"showDebugInfo"},outputs:{modalClose:"modalClose",modalOpen:"modalOpen",componentLoaded:"componentLoaded",componentLoadError:"componentLoadError"},ngContentSelectors:K,decls:1,vars:1,consts:[["modalBackdrop",""],["modalContainer",""],["dynamicComponentContainer",""],["class","fixed inset-0 flex items-center justify-center transition-all duration-300 ease-in-out",3,"z-40","z-index","class","click",4,"ngIf"],[1,"fixed","inset-0","flex","items-center","justify-center","transition-all","duration-300","ease-in-out",3,"click"],[1,"absolute","inset-0","bg-black","transition-opacity","duration-300"],[1,"relative","bg-white","rounded-lg","shadow-xl","transform","transition-all","duration-300","ease-in-out","max-w-full","max-h-full","overflow-hidden",3,"click"],["class","flex items-center justify-between p-4 border-b border-base-300 bg-base-100 text-base-content",4,"ngIf"],[1,"p-4","overflow-auto","max-h-full","bg-base-100"],["class","flex items-center justify-center py-8",4,"ngIf"],["class","mb-4 p-4 bg-red-100 border border-red-300 rounded text-red-700",4,"ngIf"],["class","mb-4 p-2 bg-yellow-100 border border-yellow-300 rounded text-xs",4,"ngIf"],[1,"dynamic-component-container"],["class","text-center py-8 text-gray-500",4,"ngIf"],[1,"flex","items-center","justify-between","p-4","border-b","border-base-300","bg-base-100","text-base-content"],["class","text-lg font-semibold",4,"ngIf"],["type","button","class","text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm w-8 h-8 inline-flex justify-center items-center transition-colors duration-200","aria-label","Fechar modal",3,"click",4,"ngIf"],[1,"text-lg","font-semibold"],["type","button","aria-label","Fechar modal",1,"text-gray-400","bg-transparent","hover:bg-gray-200","hover:text-gray-900","rounded-lg","text-sm","w-8","h-8","inline-flex","justify-center","items-center","transition-colors","duration-200",3,"click"],["aria-hidden","true","xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 14 14",1,"w-3","h-3"],["stroke","currentColor","stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","m1 1 6 6m0 0 6 6M7 7l6-6M7 7l-6 6"],[1,"flex","items-center","justify-center","py-8"],[1,"animate-spin","rounded-full","h-8","w-8","border-b-2","border-blue-500"],[1,"ml-2","text-gray-600"],[1,"mb-4","p-4","bg-red-100","border","border-red-300","rounded","text-red-700"],[1,"mt-2","px-3","py-1","bg-red-500","text-white","rounded","text-sm","hover:bg-red-600",3,"click"],[1,"mb-4","p-2","bg-yellow-100","border","border-yellow-300","rounded","text-xs"],[1,"font-bold"],[1,"text-center","py-8","text-gray-500"],[1,"text-sm","mt-2"]],template:function(t,s){t&1&&(B(),g(0,te,14,21,"div",3)),t&2&&f("ngIf",s.isOpen())},dependencies:[H,Q],styles:["[_nghost-%COMP%]{display:contents}.dynamic-component-container[_ngcontent-%COMP%]{min-height:20px}"]})}return o})();export{R as a,me as b};
